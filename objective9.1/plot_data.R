library("Hmisc")

data_lttng <- read.csv("git/compare_tracers/objective9.1/results/getuid_pthread_lttng.csv")
print(data_lttng)
#error_bars <- data_lttng$std/sqrt(data_lttng$sample_size)
#print(error_bars)
plot(data_lttng$no_thread,data_lttng$mean, xlab="Number of threads", ylab="Mean time per getuid call", main=paste("Lttng\noutput = ", data_lttng$output[1], ",", data_lttng$overflow[1], ", num-subbuf =", data_lttng$num_subbuf[1], ", subbuf-size =", data_lttng$subbuf_size[1], "k"))

data_lttng_snapshot <- read.csv("git/compare_tracers/objective9.1/results/getuid_pthread_lttng_snapshot.csv")
print(data_lttng_snapshot)
plot(data_lttng_snapshot$no_thread,data_lttng_snapshot$mean, xlab="Number of threads", ylab="Mean time per getuid call", main=paste("Lttng\nSnapshot mode, output = ", data_lttng_snapshot$num_subbuf[1], ", subbuf-size =", data_lttng_snapshot$subbuf_size[1], "k"))

data_system_tap <- read.csv("git/compare_tracers/objective9.1/results/getuid_pthread_system_tap.csv")
print(data_system_tap)
plot(data_system_tap$no_thread, data_system_tap$mean, xlab="Number of threads", ylab="Mean time per getuid call", main="System tap")

data_perf <- read.csv("git/compare_tracers/objective9.1/results/getuid_pthread_perf.csv")
print(data_perf)
plot(data_perf$no_thread,data_perf$mean, xlab="Number of threads", ylab="Mean time per getuid call", main="Perf")

data_ftrace <- read.csv("git/compare_tracers/objective9.1/results/getuid_pthread_ftrace.csv")
print(data_ftrace)
plot(data_ftrace$no_thread,data_ftrace$mean, xlab="Number of threads", ylab="Mean time per getuid call", main="Ftrace (trace-cmd)")

data_stap <- subset(data_system_tap, probe_content=="print entry and exit to file with gettimeofday_us() timestamp")
y_range <- range(c(data_lttng$mean, data_lttng_snapshot$mean, data_stap$mean, data_perf$mean, data_ftrace$mean))
plot(data_lttng$no_thread, data_lttng$mean, ylim=y_range, pch=1, xlab="number of threads", ylab="mean time per syscall getuid")
par(new=T)
plot(data_lttng_snapshot$no_thread, data_lttng_snapshot$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=2)
par(new=T)
plot(data_stap$no_thread, data_stap$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=3)
par(new=T)
plot(data_perf$no_thread, data_perf$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=4)
par(new=T)
plot(data_ftrace$no_thread, data_ftrace$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=5)
legend("topleft", c("lttng","lttng snapshot","system tap","perf","ftrace (trace-cmd)"), pch = c(1,2,3,4,5))
y_range <- c(1000, 5000)
plot(data_lttng$no_thread, data_lttng$mean, ylim=y_range, pch=1, xlab="number of threads", ylab="mean time per syscall getuid")
par(new=T)
plot(data_lttng_snapshot$no_thread, data_lttng_snapshot$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=2)
par(new=T)
plot(data_stap$no_thread, data_stap$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=3)
par(new=T)
plot(data_perf$no_thread, data_perf$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=4)
par(new=T)
plot(data_ftrace$no_thread, data_ftrace$mean, ylim=y_range, axes=F, xlab="", ylab="", pch=5)
legend("bottomright", c("lttng","lttng snapshot","system tap","perf","ftrace (trace-cmd)"), pch = c(1,2,3,4,5))
